# 代理配置快速指南

## 一分钟配置

### 第1步：配置环境变量

编辑项目根目录的 `.env` 文件（如果没有，复制 `.env.example`）：

```bash
# 添加以下配置（使用你的代理地址）
HTTP_PROXY=http://127.0.0.1:7980
HTTPS_PROXY=http://127.0.0.1:7980
WS_PROXY=http://127.0.0.1:7980
NO_PROXY=localhost,127.0.0.1
```

### 第2步：测试配置

```bash
# 测试代理配置
node test-proxy.js
```

### 第3步：运行系统

```bash
# 运行套利机器人
npm run start:onchain-bot

# 或运行Jito监控
npm run jito-monitor

# 或开发模式
npm run dev
```

---

## 代理类型支持

### HTTP/HTTPS 代理
```bash
HTTP_PROXY=http://127.0.0.1:7980
```

### SOCKS5 代理
```bash
HTTP_PROXY=socks5://127.0.0.1:1080
```

### 带认证的代理
```bash
HTTP_PROXY=http://用户名:密码@代理地址:端口
```

---

## 系统覆盖范围

✅ **已全面支持代理的组件：**

1. **Jupiter API** - DEX交换报价和交易
2. **Jito API** - Bundle小费数据获取
3. **Jito WebSocket** - 实时小费数据流
4. **Solana RPC** - 所有区块链连接
5. **其他HTTP请求** - 所有axios请求

---

## 验证代理生效

运行任意命令后，查看日志输出：

```
[ProxyConfig] 代理配置已加载 { 
  http: 'http://127.0.0.1:7980', 
  https: 'http://127.0.0.1:7980' 
}
```

看到此日志说明代理已成功配置！

---

## 故障排查

### 问题1：代理连接失败

**检查清单：**
- ✅ 代理服务器是否正在运行？
- ✅ 代理地址和端口是否正确？
- ✅ 防火墙是否允许连接？

**测试命令：**
```bash
curl -x http://127.0.0.1:7980 https://www.google.com
```

### 问题2：WebSocket无法连接

**原因：** 某些HTTP代理不支持WebSocket

**解决方案：** 使用SOCKS5代理
```bash
WS_PROXY=socks5://127.0.0.1:1080
```

### 问题3：某些请求不想走代理

**解决方案：** 添加到NO_PROXY列表
```bash
NO_PROXY=localhost,127.0.0.1,本地API地址
```

---

## 常用代理工具

- **Clash** - 图形化代理工具（Windows/Mac/Linux）
- **V2Ray** - 强大的代理工具
- **Shadowsocks** - 轻量级代理
- **Squid** - 企业级HTTP代理
- **SSH Tunnel** - 使用SSH作为代理

大多数工具默认监听 `127.0.0.1:7890` 或 `127.0.0.1:1080`

---

## 完整文档

详细配置说明请查看：**[PROXY_SETUP.md](./PROXY_SETUP.md)**

包含：
- 架构说明
- 高级配置
- 安全建议
- 生产环境部署
- API参考
