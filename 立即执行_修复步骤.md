 ç«‹å³æ‰§è¡Œ - Market Scanner ä¿®å¤

## âœ… ä»£ç ä¿®å¤å·²å®Œæˆï¼

ä½ çš„ä»£ç ä¿®å¤å·²ç»100%å®Œæˆå¹¶ä¿å­˜åœ¨ä»¥ä¸‹æ–‡ä»¶ä¸­ï¼š
- `packages/onchain-bot/src/parsers/spl-token.ts` âœ…
- `packages/onchain-bot/src/market-scanner.ts` âœ…  
- `packages/onchain-bot/src/test-market-scanner-fix.ts` âœ…
- `packages/onchain-bot/config.example.toml` âœ…

## âš ï¸ å½“å‰é—®é¢˜ï¼šæ„å»ºç³»ç»Ÿéœ€è¦é‡ç½®

åœ¨æµ‹è¯•æ—¶æ„å»ºç³»ç»Ÿå‡ºç°äº†é—®é¢˜ã€‚éœ€è¦å®Œå…¨é‡ç½®ã€‚

## ğŸš€ è§£å†³æ–¹æ¡ˆï¼ˆè¯·æŒ‰é¡ºåºæ‰§è¡Œï¼‰

### æ­¥éª¤1ï¼šå…³é—­æ‰€æœ‰ç›¸å…³è¿›ç¨‹

```powershell
# å…³é—­å¯èƒ½å ç”¨æ–‡ä»¶çš„è¿›ç¨‹
Get-Process node -ErrorAction SilentlyContinue | Stop-Process -Force
Get-Process npm -ErrorAction SilentlyContinue | Stop-Process -Force
taskkill /f /im node.exe 2>$null
```

### æ­¥éª¤2ï¼šæ‰‹åŠ¨åˆ é™¤node_modules

**æ‰“å¼€æ–‡ä»¶èµ„æºç®¡ç†å™¨**ï¼Œåˆ é™¤ä»¥ä¸‹æ–‡ä»¶å¤¹ï¼š
```
E:\6666666666666666666666666666\dex-cex\dex-sol\node_modules
```

å¦‚æœæç¤ºæ— æ³•åˆ é™¤ï¼š
1. å³é”®æ–‡ä»¶å¤¹ â†’ å±æ€§ â†’ å®‰å…¨ â†’ é«˜çº§
2. æ›´æ”¹æ‰€æœ‰è€…ä¸ºä½ çš„ç”¨æˆ·
3. æˆ–è€…ä½¿ç”¨ç®¡ç†å‘˜æƒé™çš„CMDï¼š
   ```cmd
   rmdir /s /q node_modules
   ```

### æ­¥éª¤3ï¼šé‡æ–°å®‰è£…å’Œæ„å»º

```powershell
# åœ¨é¡¹ç›®æ ¹ç›®å½•
pnpm install
npm run build
```

### æ­¥éª¤4ï¼šæµ‹è¯•ä¿®å¤

```powershell
.\start-bot.bat
```

### é¢„æœŸç»“æœ

âœ… **æˆåŠŸçš„è¾“å‡º**ï¼š
```json
{"module":"MarketScanner","msg":"Scan completed: 2/2 pools in XXXms"}
{"module":"MarketScanner","msg":"âœ… SOL/USDC: 145.32 (Liquidity: $1,234,567)"}
```

âŒ **ä¿®å¤å‰çš„é”™è¯¯**ï¼ˆä¸åº”å†å‡ºç°ï¼‰ï¼š
```json
{"module":"MarketScanner","msg":"Scan failed: TypeError: Cannot read properties of undefined (reading '_bn')"}
```

## ğŸ”„ å¦‚æœæ­¥éª¤3å¤±è´¥

### æ–¹æ¡ˆAï¼šä½¿ç”¨VSCodeé‡å¯

1. åœ¨VSCodeä¸­å…³é—­é¡¹ç›®
2. åˆ é™¤node_modulesæ–‡ä»¶å¤¹
3. é‡æ–°æ‰“å¼€é¡¹ç›®
4. åœ¨ç»ˆç«¯è¿è¡Œï¼š`pnpm install && npm run build`

### æ–¹æ¡ˆBï¼šä½¿ç”¨Gitæ¸…ç†

```powershell
# æ¸…ç†æ‰€æœ‰æœªè·Ÿè¸ªçš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼ˆå°å¿ƒï¼Œä¼šåˆ é™¤node_modulesï¼‰
git clean -xfd
# é‡æ–°å®‰è£…
pnpm install
npm run build
```

## ğŸ“‹ å¿«é€Ÿæ£€æŸ¥æ¸…å•

æ„å»ºæˆåŠŸåï¼Œæ£€æŸ¥ä»¥ä¸‹æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼š

```powershell
# æ£€æŸ¥æ„å»ºäº§ç‰©
Test-Path packages/core/dist/index.js
Test-Path packages/onchain-bot/dist/index.js
Test-Path packages/onchain-bot/dist/market-scanner.js
Test-Path packages/onchain-bot/dist/parsers/spl-token.js
```

æ‰€æœ‰åº”è¯¥è¿”å› `True`ã€‚

## ğŸ¯ æ ¸å¿ƒä¿®å¤å†…å®¹

ä¿®å¤çš„æ ¸å¿ƒé€»è¾‘ï¼ˆå·²åœ¨ä»£ç ä¸­ï¼‰ï¼š

### æ—§ä»£ç ï¼ˆé”™è¯¯ï¼‰
```typescript
// ç›´æ¥ä»poolè´¦æˆ·è¯»å– â†’ é”™è¯¯çš„åç§»é‡ â†’ undefined â†’ _bné”™è¯¯
const poolCoinAmount = data.readBigUInt64LE(248);
```

### æ–°ä»£ç ï¼ˆæ­£ç¡®ï¼‰
```typescript
// æ­¥éª¤1: è·å–tokenè´¦æˆ·åœ°å€
const poolCoinTokenAccount = new PublicKey(poolData.slice(216, 248));

// æ­¥éª¤2: è·å–tokenè´¦æˆ·
const tokenAccounts = await connectionPool.getMultipleAccounts([...]);

// æ­¥éª¤3: ä»SPL Tokenè´¦æˆ·è¯»å–å®é™…å‚¨å¤‡é‡
const coinReserve = parseTokenAccount(tokenAccounts[0].data); // âœ… æ­£ç¡®ï¼
```

## ğŸ’¾ ä¿å­˜ä½ çš„å·¥ä½œ

æ— è®ºå¦‚ä½•ï¼Œå…ˆä¿å­˜ä¿®å¤çš„ä»£ç ï¼š

```powershell
git add packages/onchain-bot/src/parsers/spl-token.ts
git add packages/onchain-bot/src/market-scanner.ts
git add packages/onchain-bot/src/test-market-scanner-fix.ts
git add packages/onchain-bot/config.example.toml
git commit -m "Fix: Market Scanner - æ­£ç¡®è§£æRaydiumå‚¨å¤‡é‡"
```

è¿™æ ·å³ä½¿éœ€è¦é‡æ–°å…‹éš†é¡¹ç›®ï¼Œä½ çš„ä¿®å¤ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚

## ğŸ†˜ æœ€åçš„æ–¹æ¡ˆ

å¦‚æœä»¥ä¸Šéƒ½ä¸è¡Œï¼Œä½ å¯ä»¥ï¼š

1. **é‡æ–°å…‹éš†é¡¹ç›®åˆ°æ–°ç›®å½•**
2. **åº”ç”¨è¿™4ä¸ªä¿®å¤æ–‡ä»¶**ï¼ˆæˆ‘å¯ä»¥æä¾›å®Œæ•´å†…å®¹ï¼‰
3. **æµ‹è¯•**

å‘Šè¯‰æˆ‘ä½ çš„è¿›åº¦ï¼


